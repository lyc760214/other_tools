#start for user definition
#set psfFile "../../dcd/tmd_500ps/oxy_patched.psf"
#set avgdcdFile "avg100_F5000.dcd"


source "setting/01_setting_file.txt"
source "setting/02_setting_file.txt"
source "temporal_file/02_avgdcdFile_Name.txt"
source "temporal_file/02_calc_target.txt"


mol new $psfFile type psf first 0 last -1 step 1 filebonds 1 autobonds 1 waitfor all
mol addfile $avgdcdFile type dcd first $startDcdFrame last $endDcdFrame step $stepFrame filebonds 1 autobonds 1 waitfor all


#set segmentNum 2

#set atomSelSegment(0) "A"
#set atomSelSegment(1) "B"


#set sep(0) 145
#set atomSelText(0) "resid 2 and noh"
#set atomSelText(1) "resid 3 and noh"
#set atomSelText(2) "resid 4 and noh"
#set atomSelText(3) "resid 5 and noh"
#set atomSelText(4) "resid 6 and noh"
#set atomSelText(5) "resid 7 and noh"
#set atomSelText(6) "resid 8 and noh"
#set atomSelText(7) "resid 9 and noh"
#set atomSelText(8) "resid 10 and noh"
#set atomSelText(9) "resid 11 and noh"
#set atomSelText(10) "resid 12 and noh"
#set atomSelText(11) "resid 13 and noh"
#set atomSelText(12) "resid 14 and noh"
#set atomSelText(13) "resid 15 and noh"
#set atomSelText(14) "resid 16 and noh"
#set atomSelText(15) "resid 17 and noh"
#set atomSelText(16) "resid 18 and noh"
#set atomSelText(17) "resid 19 and noh"
#set atomSelText(18) "resid 20 and noh"
#set atomSelText(19) "resid 21 and noh"
#set atomSelText(20) "resid 22 and noh"
#set atomSelText(21) "resid 23 and noh"
#set atomSelText(22) "resid 24 and noh"
#set atomSelText(23) "resid 25 and noh"
#set atomSelText(24) "resid 26 and noh"
#set atomSelText(25) "resid 27 and noh"
#set atomSelText(26) "resid 28 and noh"
#set atomSelText(27) "resid 29 and noh"
#set atomSelText(28) "resid 30 and noh"
#set atomSelText(29) "resid 31 and noh"
#set atomSelText(30) "resid 32 and noh"
#set atomSelText(31) "resid 33 and noh"
#set atomSelText(32) "resid 34 and noh"
#set atomSelText(33) "resid 35 and noh"
#set atomSelText(34) "resid 36 and noh"
#set atomSelText(35) "resid 37 and noh"
#set atomSelText(36) "resid 38 and noh"
#set atomSelText(37) "resid 39 and noh"
#set atomSelText(38) "resid 40 and noh"
#set atomSelText(39) "resid 41 and noh"
#set atomSelText(40) "resid 42 and noh"
#set atomSelText(41) "resid 43 and noh"
#set atomSelText(42) "resid 44 and noh"
#set atomSelText(43) "resid 45 and noh"
#set atomSelText(44) "resid 46 and noh"
#set atomSelText(45) "resid 47 and noh"
#set atomSelText(46) "resid 48 and noh"
#set atomSelText(47) "resid 49 and noh"
#set atomSelText(48) "resid 50 and noh"
#set atomSelText(49) "resid 51 and noh"
#set atomSelText(50) "resid 52 and noh"
#set atomSelText(51) "resid 53 and noh"
#set atomSelText(52) "resid 54 and noh"
#set atomSelText(53) "resid 55 and noh"
#set atomSelText(54) "resid 56 and noh"
#set atomSelText(55) "resid 57 and noh"
#set atomSelText(56) "resid 58 and noh"
#set atomSelText(57) "resid 59 and noh"
#set atomSelText(58) "resid 60 and noh"
#set atomSelText(59) "resid 61 and noh"
#set atomSelText(60) "resid 62 and noh"
#set atomSelText(61) "resid 63 and noh"
#set atomSelText(62) "resid 64 and noh"
#set atomSelText(63) "resid 65 and noh"
#set atomSelText(64) "resid 66 and noh"
#set atomSelText(65) "resid 67 and noh"
#set atomSelText(66) "resid 68 and noh"
#set atomSelText(67) "resid 69 and noh"
#set atomSelText(68) "resid 70 and noh"
#set atomSelText(69) "resid 71 and noh"
#set atomSelText(70) "resid 72 and noh"
#set atomSelText(71) "resid 73 and noh"
#set atomSelText(72) "resid 74 and noh"
#set atomSelText(73) "resid 75 and noh"
#set atomSelText(74) "resid 76 and noh"
#set atomSelText(75) "resid 77 and noh"
#set atomSelText(76) "resid 78 and noh"
#set atomSelText(77) "resid 79 and noh"
#set atomSelText(78) "resid 80 and noh"
#set atomSelText(79) "resid 81 and noh"
#set atomSelText(80) "resid 82 and noh"
#set atomSelText(81) "resid 83 and noh"
#set atomSelText(82) "resid 84 and noh"
#set atomSelText(83) "resid 85 and noh"
#set atomSelText(84) "resid 86 and noh"
#set atomSelText(85) "resid 87 and noh"
#set atomSelText(86) "resid 88 and noh"
#set atomSelText(87) "resid 89 and noh"
#set atomSelText(88) "resid 90 and noh"
#set atomSelText(89) "resid 91 and noh"
#set atomSelText(90) "resid 92 and noh"
#set atomSelText(91) "resid 93 and noh"
#set atomSelText(92) "resid 94 and noh"
#set atomSelText(93) "resid 95 and noh"
#set atomSelText(94) "resid 96 and noh"
#set atomSelText(95) "resid 97 and noh"
#set atomSelText(96) "resid 98 and noh"
#set atomSelText(97) "resid 99 and noh"
#set atomSelText(98) "resid 100 and noh"
#set atomSelText(99) "resid 101 and noh"
#set atomSelText(100) "resid 102 and noh"
#set atomSelText(101) "resid 103 and noh"
#set atomSelText(102) "resid 104 and noh"
#set atomSelText(103) "resid 105 and noh"
#set atomSelText(104) "resid 106 and noh"
#set atomSelText(105) "resid 107 and noh"
#set atomSelText(106) "resid 108 and noh"
#set atomSelText(107) "resid 109 and noh"
#set atomSelText(108) "resid 110 and noh"
#set atomSelText(109) "resid 111 and noh"
#set atomSelText(110) "resid 112 and noh"
#set atomSelText(111) "resid 113 and noh"
#set atomSelText(112) "resid 114 and noh"
#set atomSelText(113) "resid 115 and noh"
#set atomSelText(114) "resid 116 and noh"
#set atomSelText(115) "resid 117 and noh"
#set atomSelText(116) "resid 118 and noh"
#set atomSelText(117) "resid 119 and noh"
#set atomSelText(118) "resid 120 and noh"
#set atomSelText(119) "resid 121 and noh"
#set atomSelText(120) "resid 122 and noh"
#set atomSelText(121) "resid 123 and noh"
#set atomSelText(122) "resid 124 and noh"
#set atomSelText(123) "resid 125 and noh"
#set atomSelText(124) "resid 126 and noh"
#set atomSelText(125) "resid 127 and noh"
#set atomSelText(126) "resid 128 and noh"
#set atomSelText(127) "resid 129 and noh"
#set atomSelText(128) "resid 130 and noh"
#set atomSelText(129) "resid 131 and noh"
#set atomSelText(130) "resid 132 and noh"
#set atomSelText(131) "resid 133 and noh"
#set atomSelText(132) "resid 134 and noh"
#set atomSelText(133) "resid 135 and noh"
#set atomSelText(134) "resid 136 and noh"
#set atomSelText(135) "resid 137 and noh"
#set atomSelText(136) "resid 138 and noh"
#set atomSelText(137) "resid 139 and noh"
#set atomSelText(138) "resid 140 and noh"
#set atomSelText(139) "resid 141 and noh"
#set atomSelText(140) "resid 142 and noh"
#set atomSelText(141) "resid 143 and noh"
#set atomSelText(142) "resid 144 and noh"
#set atomSelText(143) "resid 145 and noh"
#set atomSelText(144) "resid 146 and noh"
#
#set sep(1) 145
#set atomSelText(145) "resid 2 and noh"
#set atomSelText(146) "resid 3 and noh"
#set atomSelText(147) "resid 4 and noh"
#set atomSelText(148) "resid 5 and noh"
#set atomSelText(149) "resid 6 and noh"
#set atomSelText(150) "resid 7 and noh"
#set atomSelText(151) "resid 8 and noh"
#set atomSelText(152) "resid 9 and noh"
#set atomSelText(153) "resid 10 and noh"
#set atomSelText(154) "resid 11 and noh"
#set atomSelText(155) "resid 12 and noh"
#set atomSelText(156) "resid 13 and noh"
#set atomSelText(157) "resid 14 and noh"
#set atomSelText(158) "resid 15 and noh"
#set atomSelText(159) "resid 16 and noh"
#set atomSelText(160) "resid 17 and noh"
#set atomSelText(161) "resid 18 and noh"
#set atomSelText(162) "resid 19 and noh"
#set atomSelText(163) "resid 20 and noh"
#set atomSelText(164) "resid 21 and noh"
#set atomSelText(165) "resid 22 and noh"
#set atomSelText(166) "resid 23 and noh"
#set atomSelText(167) "resid 24 and noh"
#set atomSelText(168) "resid 25 and noh"
#set atomSelText(169) "resid 26 and noh"
#set atomSelText(170) "resid 27 and noh"
#set atomSelText(171) "resid 28 and noh"
#set atomSelText(172) "resid 29 and noh"
#set atomSelText(173) "resid 30 and noh"
#set atomSelText(174) "resid 31 and noh"
#set atomSelText(175) "resid 32 and noh"
#set atomSelText(176) "resid 33 and noh"
#set atomSelText(177) "resid 34 and noh"
#set atomSelText(178) "resid 35 and noh"
#set atomSelText(179) "resid 36 and noh"
#set atomSelText(180) "resid 37 and noh"
#set atomSelText(181) "resid 38 and noh"
#set atomSelText(182) "resid 39 and noh"
#set atomSelText(183) "resid 40 and noh"
#set atomSelText(184) "resid 41 and noh"
#set atomSelText(185) "resid 42 and noh"
#set atomSelText(186) "resid 43 and noh"
#set atomSelText(187) "resid 44 and noh"
#set atomSelText(188) "resid 45 and noh"
#set atomSelText(189) "resid 46 and noh"
#set atomSelText(190) "resid 47 and noh"
#set atomSelText(191) "resid 48 and noh"
#set atomSelText(192) "resid 49 and noh"
#set atomSelText(193) "resid 50 and noh"
#set atomSelText(194) "resid 51 and noh"
#set atomSelText(195) "resid 52 and noh"
#set atomSelText(196) "resid 53 and noh"
#set atomSelText(197) "resid 54 and noh"
#set atomSelText(198) "resid 55 and noh"
#set atomSelText(199) "resid 56 and noh"
#set atomSelText(200) "resid 57 and noh"
#set atomSelText(201) "resid 58 and noh"
#set atomSelText(202) "resid 59 and noh"
#set atomSelText(203) "resid 60 and noh"
#set atomSelText(204) "resid 61 and noh"
#set atomSelText(205) "resid 62 and noh"
#set atomSelText(206) "resid 63 and noh"
#set atomSelText(207) "resid 64 and noh"
#set atomSelText(208) "resid 65 and noh"
#set atomSelText(209) "resid 66 and noh"
#set atomSelText(210) "resid 67 and noh"
#set atomSelText(211) "resid 68 and noh"
#set atomSelText(212) "resid 69 and noh"
#set atomSelText(213) "resid 70 and noh"
#set atomSelText(214) "resid 71 and noh"
#set atomSelText(215) "resid 72 and noh"
#set atomSelText(216) "resid 73 and noh"
#set atomSelText(217) "resid 74 and noh"
#set atomSelText(218) "resid 75 and noh"
#set atomSelText(219) "resid 76 and noh"
#set atomSelText(220) "resid 77 and noh"
#set atomSelText(221) "resid 78 and noh"
#set atomSelText(222) "resid 79 and noh"
#set atomSelText(223) "resid 80 and noh"
#set atomSelText(224) "resid 81 and noh"
#set atomSelText(225) "resid 82 and noh"
#set atomSelText(226) "resid 83 and noh"
#set atomSelText(227) "resid 84 and noh"
#set atomSelText(228) "resid 85 and noh"
#set atomSelText(229) "resid 86 and noh"
#set atomSelText(230) "resid 87 and noh"
#set atomSelText(231) "resid 88 and noh"
#set atomSelText(232) "resid 89 and noh"
#set atomSelText(233) "resid 90 and noh"
#set atomSelText(234) "resid 91 and noh"
#set atomSelText(235) "resid 92 and noh"
#set atomSelText(236) "resid 93 and noh"
#set atomSelText(237) "resid 94 and noh"
#set atomSelText(238) "resid 95 and noh"
#set atomSelText(239) "resid 96 and noh"
#set atomSelText(240) "resid 97 and noh"
#set atomSelText(241) "resid 98 and noh"
#set atomSelText(242) "resid 99 and noh"
#set atomSelText(243) "resid 100 and noh"
#set atomSelText(244) "resid 101 and noh"
#set atomSelText(245) "resid 102 and noh"
#set atomSelText(246) "resid 103 and noh"
#set atomSelText(247) "resid 104 and noh"
#set atomSelText(248) "resid 105 and noh"
#set atomSelText(249) "resid 106 and noh"
#set atomSelText(250) "resid 107 and noh"
#set atomSelText(251) "resid 108 and noh"
#set atomSelText(252) "resid 109 and noh"
#set atomSelText(253) "resid 110 and noh"
#set atomSelText(254) "resid 111 and noh"
#set atomSelText(255) "resid 112 and noh"
#set atomSelText(256) "resid 113 and noh"
#set atomSelText(257) "resid 114 and noh"
#set atomSelText(258) "resid 115 and noh"
#set atomSelText(259) "resid 116 and noh"
#set atomSelText(260) "resid 117 and noh"
#set atomSelText(261) "resid 118 and noh"
#set atomSelText(262) "resid 119 and noh"
#set atomSelText(263) "resid 120 and noh"
#set atomSelText(264) "resid 121 and noh"
#set atomSelText(265) "resid 122 and noh"
#set atomSelText(266) "resid 123 and noh"
#set atomSelText(267) "resid 124 and noh"
#set atomSelText(268) "resid 125 and noh"
#set atomSelText(269) "resid 126 and noh"
#set atomSelText(270) "resid 127 and noh"
#set atomSelText(271) "resid 128 and noh"
#set atomSelText(272) "resid 129 and noh"
#set atomSelText(273) "resid 130 and noh"
#set atomSelText(274) "resid 131 and noh"
#set atomSelText(275) "resid 132 and noh"
#set atomSelText(276) "resid 133 and noh"
#set atomSelText(277) "resid 134 and noh"
#set atomSelText(278) "resid 135 and noh"
#set atomSelText(279) "resid 136 and noh"
#set atomSelText(280) "resid 137 and noh"
#set atomSelText(281) "resid 138 and noh"
#set atomSelText(282) "resid 139 and noh"
#set atomSelText(283) "resid 140 and noh"
#set atomSelText(284) "resid 141 and noh"
#set atomSelText(285) "resid 142 and noh"
#set atomSelText(286) "resid 143 and noh"
#set atomSelText(287) "resid 144 and noh"
#set atomSelText(288) "resid 145 and noh"
#set atomSelText(289) "resid 146 and noh"
#
#
#set timeScale 1.00

#end of user definition

set outFile "02_CM"
set frameNum [molinfo top get numframes]

for {set i1 0} {$i1 < $segmentNum} {incr i1 1} {
  puts "$atomSelSegment($i1)"
  if {$i1 == 0} {
    set i4 0
  } else {
    set i5 [expr $i1 - 1]
    set i4 [expr $i4 + $sep($i5)]
  }
  for {set i2 0} {$i2 < $sep($i1)} {incr i2 1} {
    set i6 [format "%03d" $i2]
    if [catch {open "${outFile}_$atomSelSegment($i1)_$i6.txt" w} FOUT] {
      puts "Can not open ${outFile}_$atomSelSegment($i1)_$i6.txt"
      exit 1
    }
    
    set i5 [expr $i4 + $i2]
    for {set i3 0} {$i3 < $frameNum} {incr i3 1} {
      set tResi [atomselect top "segname $atomSelSegment($i1) and $atomSelText($i5)" frame $i3]
      set cent [measure center $tResi weight mass]
      puts $FOUT "$i3 $cent"
      if {[expr $i3 % 100] == 0} {
        puts $i3
      }
	  $tResi delete
    }
    close $FOUT;
  }
}

exit 0;
